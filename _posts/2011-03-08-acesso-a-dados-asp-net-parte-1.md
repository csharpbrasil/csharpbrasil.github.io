---
title: 'Acesso à Dados com ASP.NET - Parte 1'
date: Tue, 08 Mar 2011 03:14:23 +0000
draft: false
tags: ['acesso a dados', 'ADO.NET', 'ASP.NET', 'ASP.NET', 'C#', 'Sql Server']
---

**Olá pessoal, neste artigo irei criar uma aplicação ASP. NET que faz a conexão com banco de dados SQL Server.** Usarei o banco de dados SQL Server 2005 Express e Visual Studio 2008. Usarei também o banco de dados Northwind, do SQL Server 2000, que pode ser baixado [aqui](http://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&DisplayLang=en). Depois de baixar e instalar o banco, é preciso anexar este banco à instância local do SQL. Para isso, abra uma janela prompt de comando do Windows e digite o seguinte: **cd "C:\\SQL Server 2000 Sample Databases"**, para entrar na pasta onde foi instalado o banco.  Logo depois digite o seguinte: ****sqlcmd -E -S .\\SQLEXPRESS -Q "EXEC sp\_attach\_db N'Northwind', N'c:\\SQL Server 2000 Sample Databases\\northwnd.mdf'"****, para anexar o banco à instância do SQL instalado em seu pc. Deve aparecer a imagem abaixo se você fez tudo certo:  _****![](http://programandodotnet.files.wordpress.com/2010/01/012210_0202_acessodados1.jpg)****_ **Feito isso, podemos criar a aplicação no Visual Studio como mostra a imagem:** ![](http://programandodotnet.files.wordpress.com/2010/01/012210_0202_acessodados2.jpg) Agora abra o menu lateral esquerdo, Server Explorer, ou tecle _CTRL+ALT+S_ , clique com o botão direito em cima de Data Connections e clique em Add Connection. Na janela Server name digite .\\SQLEXPRESS, que informa ao Visual Studio que o SQL Server está instalado localmente em sua máquina. Em Log on to the server, escolha Use Windows Authentication, em Connect to a database, selecione no combo o database Northwind e clique em Test Connection. Se tudo ocorreu bem, deve aparecer como na imagem abaixo: ![](http://programandodotnet.files.wordpress.com/2010/01/012210_0202_acessodados3.jpg) Ok, agora temos nosso banco de dados configurado em nossa aplicação! Abra novamente o Server Explorer, clique no database Northwind, recém criado e perceba que temos diversas tabelas, stored procedures e views. Abra a pasta Tables, escolha uma tabela qualquer, Employees por exemplo, clique com o botão direito em cima dela e clique em New Query. Irá aparecer uma janela pedindo para adicionar tabela(s) ao Query Designer, escolha Employees, clique em Add e em Close. A janela que aparece é o Query Designer do Visual Studio. Com ele podemos manipular quantas tabelas quisermos com poucos cliques. ![](http://programandodotnet.files.wordpress.com/2010/01/012210_0202_acessodados4.jpg) Como você pode ver na imagem acima, o Query Designer é composto de alguns painéis, o primeiro se chama Diagram e mostra nossa tabela, o segundo se chama Criteria e nele podemos definir alguns parâmetros da query, como ordenação, filtros, etc. O terceiro painel é o SQL, onde fica nossa query e o quarto se chama Results, que como o nome diz, mostra o resultado da query. Como exemplo, selecione em nossa tabela os campos First Name e Birth Date, em Sort Type, no 2º painel, escolha Descending (ordem descendente) e clique no menu em Query Designer > Execute SQL ou tecle _CTRL+R._ Na imagem abaixo, mostramos o resultado de nossa query: ![](http://programandodotnet.files.wordpress.com/2010/01/012210_0202_acessodados5.jpg) Ok pessoal, nesta 1ª parte de nosso artigo, mostrei a vocês como anexar um banco de dados do SQL Server 2000 para usá-lo na instância local do 2005, criamos um website no Visual Studio, adicionamos e configuramos um database à ele e usamos a ferramenta Query Designer. Na próxima parte, adicionaremos o banco de dados à nossa aplicação, por meio da pasta App\_Data. Também aprenderemos o que são os Data Providers e quais os seus objetos mais usados. Quaisquer dúvidas, só publicar nos comentários ou enviar um email para wellingtonbalbo@gmail.com. _****_Abraços e até o próximo artigo!_****_