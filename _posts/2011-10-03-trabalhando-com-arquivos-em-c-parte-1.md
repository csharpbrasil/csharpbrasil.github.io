---
title: 'Trabalhando com Arquivos em C# - Parte 1'
date: Mon, 03 Oct 2011 10:00:24 +0000
draft: false
tags: ['arquivos', 'ASP.NET', 'C#', 'C#', 'filestream', 'streamwriter', 'system.io', 'windows forms']
---

Olá pessoal, nesta série de três artigos mostrarei como manipular arquivos texto em C# usando Windows Forms. Este exemplo simples serve também para outros tipos de arquivos. Vamos **criar**, **abrir**, **concatenar**, **alterar** e **excluir** arquivos texto, além de usar caixas de diálogo para trabalhar com eles. Faço este artigo com base nas videoaulas de [Bruno Belizário](mailto:bsbelizario@hotmail.com), do [Portal Linha de Código](http://www.linhadecodigo.com.br/), mediante autorização do mesmo. Acompanhem o passo-a-passo: Para estes artigos iremos usar as classes [FileStream](http://msdn.microsoft.com/pt-br/library/system.io.filestream%28VS.90%29.aspx), [StreamReader](http://msdn.microsoft.com/pt-br/library/system.io.streamreader%28VS.90%29.aspx) e [StreamWriter](http://msdn.microsoft.com/pt-br/library/system.io.streamwriter%28VS.90%29.aspx), todas contidas no namespace [System.IO](http://msdn.microsoft.com/pt-br/library/system.io%28v=VS.90%29.aspx), que é específico para manipular arquivos. Crie uma aplicação Windows Forms com o nome **ManipulandoArquivosTexto**. No formulário que aparece, insira cinco botões e altere os nomes para que fique desta forma, como mostra a **Figura 01**: [![](http://programandodotnet.files.wordpress.com/2010/06/form.jpg)](http://programandodotnet.files.wordpress.com/2010/06/form.jpg)

_Figura 01 - Tela do Formulário_

Nomeei o ID dos botões nesta ordem: **btnCriar**, **btnAbrir**, **btnConcatenar**, **btnAlterar** e **btnExcluir**. Devemos definir a pasta em que serão feitas as alterações em nosso arquivo texto. Neste exemplo, será definido a pasta **C:\\temp**. Definido isto, vá à página de códigos para começarmos a criar os métodos dos respectivos botões. Comece declarando o namespace **System.IO**. \[sourcecode language="csharp"\] using System.IO; \[/sourcecode\] Agora crie a propriedade privada que será referente à pasta que definimos anteriormente, onde ficará nosso arquivo que irá sofrer as alterações. Assim não temos que nos preocupar em declarar o caminho físico do arquivo toda vez em que formos usá-lo. \[sourcecode language="csharp"\] private string strPathFile = @"C:\\temp\\ArquivoExemplo.txt"; \[/sourcecode\] Perceba que já criamos o nome do arquivo e a respectiva extensão. Vamos criar agora o método referente ao botão **Criar Arquivo**. Segue abaixo o método comentado: \[sourcecode language="csharp"\] private void Criar() { try { //Usarei a cláusula using como boas práticas de programação em todos os métodos //Instancio a classe FileStream, uso a classe File e o método Create para criar o //arquivo passando como parâmetro a variável strPathFile, que contém o arquivo using (FileStream fs = File.Create(strPathFile)) { //Crio outro using, dentro dele instancio o StreamWriter (classe para gravar os dados) //que recebe como parâmetro a variável fs, referente ao FileStream criado anteriormente using (StreamWriter sw = new StreamWriter(fs)) { //Uso o método Write para escrever algo em nosso arquivo texto sw.Write("Texto adicionado ao exemplo!"); } } } catch (Exception ex) { MessageBox.Show(ex.Message); } //Se tudo ocorrer bem, exibo a mensagem ao usuário. MessageBox.Show("Arquivo criado com sucesso!!!"); } \[/sourcecode\] Agora dê dois cliques no botão **Criar Arquivo** e chame o método acima no evento do botão: \[sourcecode language="csharp"\] private void btnCriar\_Click(object sender, EventArgs e) { Criar(); } \[/sourcecode\] Salve, compile e clique no botão. Se tudo ocorreu bem deverá aparecer a mensagem de confirmação e o arquivo estará criado na pasta **temp** e com o texto adicionado, como vemos abaixo na **Figura 02**: [![](http://programandodotnet.files.wordpress.com/2010/06/createfile.jpg)](http://programandodotnet.files.wordpress.com/2010/06/createfile.jpg)

_Figura 02 - Arquivo criado na pasta Temp_

Ok, vamos criar agora o método referente ao botão **Abrir Arquivo**: \[sourcecode language="csharp"\] private void Abrir() { try { //Verifico se o arquivo que desejo abrir existe e passo como parâmetro a respectiva variável if (File.Exists(strPathFile)) { //Se existir "starto" um processo do sistema para abrir o arquivo e, sem precisar //passar ao processo o aplicativo a ser aberto, ele abre automaticamente o Notepad System.Diagnostics.Process.Start(strPathFile); } else { //Se não existir exibo a mensagem MessageBox.Show("Arquivo não encontrado!"); } } catch (Exception ex) { MessageBox.Show(ex.Message); } } \[/sourcecode\] Faça o mesmo que antes, dê dois cliques no botão **Abrir Arquivo** e chame o método recém-criado: \[sourcecode language="csharp"\] private void btnAbrir\_Click(object sender, EventArgs e) { Abrir(); } \[/sourcecode\] Salve, compile e clique no botão para ver o arquivo se abrir, como mostra a **Figura 03**: [![](http://programandodotnet.files.wordpress.com/2010/06/openfile.jpg)](http://programandodotnet.files.wordpress.com/2010/06/openfile.jpg)

_Figura 03 - Arquivo aberto pelo formulário_

Agora crie o método do botão **Concatenar Arquivo**, parecido com os métodos anteriores: \[sourcecode language="csharp"\] private void Concatenar() { try { //Verifico se o arquivo que desejo abrir existe e passo como parâmetro a respectiva variável if (File.Exists(strPathFile)) { //Crio um using, dentro dele instancio o StreamWriter, uso a classe File e o método //AppendText para concatenar o texto, passando como parâmetro a variável strPathFile using (StreamWriter sw = File.AppendText(strPathFile)) { //Uso o método Write para escrever o arquivo que será adicionado no arquivo texto sw.Write("\\r\\nTexto adicionado ao final do arquivo"); } //Exibo a mensagem que o arquivo foi atualizado MessageBox.Show("Arquivo atualizado!"); } else { //Se não existir exibo a mensagem MessageBox.Show("Arquivo não encontrado!"); } } catch (Exception ex) { MessageBox.Show(ex.Message); } } \[/sourcecode\] Chame-o no botão: \[sourcecode language="csharp"\] private void btnConcatenar\_Click(object sender, EventArgs e) { Concatenar(); } \[/sourcecode\] Salve e clique no botão. Irá aparecer a mensagem seguinte, como vemos na **Figura 04**: [![](http://programandodotnet.files.wordpress.com/2010/06/concatenatefilemsgbox.jpg)](http://programandodotnet.files.wordpress.com/2010/06/concatenatefilemsgbox.jpg)

_Figura 04 - Mensagem informando que o arquivo foi atualizado_

Agora clique em **Abrir Arquivo** e veja o texto que foi concatenado, como mostra a **Figura 05**: [![](http://programandodotnet.files.wordpress.com/2010/06/concatenatefile.jpg)](http://programandodotnet.files.wordpress.com/2010/06/concatenatefile.jpg)

_Figura 05 - Texto concatenado na abertura do arquivo_

Assim finalizo a **1ª parte** de nosso artigo. Na próxima parte criaremos os métodos para **Alterar Arquivo** e **Excluir Arquivo**. Aguardem! **Créditos** à [Bruno Belizário](mailto:bsbelizario@hotmail.com), que fez as videoaulas e ao [Portal Linha de Código](http://www.linhadecodigo.com.br/), por onde pude baixá-las (mediante assinatura), estudá-las e posteriormente fazer este artigo. Quaisquer dúvidas mandem emails para [wellingtonbalbo@gmail.com](mailto:wellingtonbalbo@gmail.com) ou deixem nos comentários deste artigo que responderei o mais rápido possível. _Até o próximo artigo!_