---
title: 'Desenvolvimento de Website com ASP.NET e SQL Server - Parte 2'
date: Sun, 29 Jan 2012 19:17:20 +0000
draft: false
tags: ['.NET', 'acesso a dados', 'ASP.NET', 'ASP.NET', 'C#', 'C#', 'CMS', 'Content Management Systems', 'CSS', 'Desenvolver website', 'Desenvolvimento de Website', 'N-Camadas', 'N-Tier', 'Sistema de gerenciamento de conteúdo', 'Sql Server', 'SQL Server', 'System.Data.OleDb', 'System.Data.SqlClient', 'Visual Studio', 'Visual Studio']
---

Olá caro leitor! Dando continuidade ao [artigo anterior](https://raphaelcardoso.com.br/desenvolvimento-de-website-com-asp-net-e-sql-server-parte-1/ "Desenvolvimento de Website com ASP.NET e SQL Server – Parte 1") que criamos o banco de dados, as tabelas, camada de conexão, camada de entidades e a camada de regras de negocio do nosso projeto, iremos iniciar o desenvolvimento do nosso website. Caso queira acessar as outras partes, veja os links abaixo:

*   [Desenvolvimento de Website com ASP.NET e SQL Server - Parte 1](https://raphaelcardoso.com.br/desenvolvimento-de-website-com-asp-net-e-sql-server-parte-1/ "Desenvolvimento de Website com ASP.NET e SQL Server – Parte 1")
*   [Desenvolvimento de Website com ASP.NET e SQL Server - Parte 2](https://raphaelcardoso.com.br/desenvolvimento-de-website-com-asp-net-e-sql-server-parte-2/ "Desenvolvimento de Website com ASP.NET e SQL Server – Parte 2")
*   [Desenvolvimento de Website com ASP.NET e SQL Server - Parte 3](https://raphaelcardoso.com.br/desenvolvimento-de-website-com-asp-net-e-sql-server-parte-3/ "Desenvolvimento de Website com ASP.NET e SQL Server – Parte 3")
*   [Desenvolvimento de Website com ASP.NET e SQL Server - Parte 4](https://raphaelcardoso.com.br/desenvolvimento-de-website-com-asp-net-e-sql-server-parte-4/ "Desenvolvimento de Website com ASP.NET e SQL Server – Parte 4")
*   [Desenvolvimento de Website com ASP.NET e SQL Server - Parte 5](https://raphaelcardoso.com.br/desenvolvimento-de-website-com-asp-net-e-sql-server-parte-5/ "Desenvolvimento de Website com ASP.NET e SQL Server – Parte 5")

Para iniciarmos, faça o download do fonte do projeto disponibilizado no [Github](https://github.com/csharpbrasil/projeto-website-aspnet). Após aberto adicione um novo Web Site conforme imagem abaixo. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0011-300x162.jpg "imagem001")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0011.jpg) Salve o novo projeto no mesmo diretório dos demais projetos anterior e defina um nome. No caso chamarei de _WebSite_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0021-300x185.jpg "imagem002")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0021.jpg) Feito isso, vamos adicionar uma MasterPage ao projeto que será o modelo visual padrão de novo projeto. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0031-300x162.jpg "imagem003")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0031.jpg) Defina um novo para a MasterPage. Deixei o nome como _MasterPage.masterpage_ mesmo. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0041-300x185.jpg "imagem004")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0041.jpg) Por padrão quando criamos um novo Web Site é automaticamente incluso uma página _Default.aspx_, deveremos exclui-la. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0051-300x162.jpg "imagem005")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0051.jpg) Inclua ao projeto uma nova pasta com o nome de _css_ para que nela possamos incluir nossa folha de estilo que será referenciada na MasterPage. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0061-300x162.jpg "imagem006")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0061.jpg) Após criado a pasta, criaremos um novo arquivo de folha de estilo conforme imagem abaixo clicando com o botão direito sobre a pasta css e selecionando a opção _Add New Item_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0071-300x162.jpg "imagem007")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0071.jpg) Defina o nome do arquivo Style Sheet como _default.css_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0081-300x185.jpg "imagem008")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0081.jpg) Depois de criado o arquivo, inclua a folha de estilo abaixo no arquivo _default.css_. \[sourcecode language='css'\] html, body, form { height: 100%; } body { font-family: Tahoma, Verdana, Arial, Sans-Serif, Times New Roman; padding: 0; margin: 0; } #geral { position: relative; min-height: 100%; } \* html #geral { height: 100%; } #cabecalho { background: #f09942; height: 150px; line-height: 150px; } #cabecalho h1 { padding: 0; margin: 0; } #cabecalho h1#logo { text-transform: uppercase; } #menu ul { overflow: auto; background-color: #353535; padding: 0; margin: 0; list-style: none; } #menu ul li { float: left; } #menu ul li a { display: block; height: 50px; line-height: 50px; padding: 5px 20px; color: #fff; text-decoration: none; } #menu ul li a:hover { color: #353535; background: #f09942; text-decoration: underline; } #conteudo { clear: both; } #rodape { position: absolute; background-color: #f09942; width: 100%; bottom: 0; left: 0; padding: 15px 0; text-align: center; font-size: small; } #rodape a { color: #000; text-decoration: none; } #rodape a:hover { color: #000; text-decoration: underline; } \[/sourcecode\] Agora abra o código HTML do nosso arquivo MasterPage e substitua pelo disponível abaixo. \[sourcecode language='html'\] <%@ Master Language="C#" AutoEventWireup="true" CodeFile="MasterPage.master.cs" Inherits="MasterPage" %>  @import url('css/default.css'); 

Projeto WebSite .NET
====================

&amp;amp;copy; 2012. Projeto WebSite .NET by [C# Brasil](http://raphaelcardoso.com.br)

\[/sourcecode\] Vamos incluir uma nova página Default.aspx que utilizará a MasterPage. Clique com o botão direito sobre o projeto e clique em _Add New Item_. Defina o nome para _default.aspx_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem023-300x162.jpg "imagem023")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem023.jpg) [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem024-300x185.jpg "imagem024")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem024.jpg) Selecione a MasterPage criada. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem025-300x182.jpg "imagem025")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem025.jpg) Teremos até o momento o nosso website igual à imagem abaixo. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0091-300x176.jpg "imagem009")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem0091.jpg) Como pode perceber, até o momento não temos o menu. Nesse caso iremos criar um _Web User Control_ especifico onde será exibido os links do menu de acordo com as páginas presentes em nosso banco de dados. Para isso clique com o botão direito em cima do projeto WebSite e clique em _Add New Item_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem010-300x162.jpg "imagem010")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem010.jpg) Adicionaremos um novo _Web User Control_ e definiremos o nome como _MenuControl.ascx_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem011-300x185.jpg "imagem011")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem011.jpg) A partir desse momento começaremos a utilização de nossas bibliotecas criadas no [artigo anterior](https://raphaelcardoso.com.br/desenvolvimento-de-website-com-asp-net-e-sql-server-parte-1/ "Desenvolvimento de Website com ASP.NET e SQL Server – Parte 1"). Clicando com o botão direito em cima do projeto Website, clique em _Add Reference_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem012-300x162.jpg "imagem012")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem012.jpg) Na aba Projects, você encontrará todas as bibliotecas presentes em nossa solutions, selecione todas. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem013-300x253.jpg "imagem013")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem013.jpg) Agora abra o código HTML do _MenuControl.ascx_ para adicionarmos o código que ficara como abaixo. \[sourcecode language='html'\] <%@ Control Language="C#" AutoEventWireup="true" CodeFile="MenuControl.ascx.cs" Inherits="MenuControl" %>

*   Página inicial
*   Contato

\[/sourcecode\] Como pode ver no código anterior, foi criado uma lista HTML já com 2 (dois) links, Página inicial e Contato. Entre eles adicionamos um Server Control do tipo Literal. _O Server Control do tipo Literal é um componente para escrever textos em tela, ou seja, se escreve um texto sem que seja gerado tag HTML_. No nosso caso usaremos para criar os itens do menu. Agora abra o _CodeBehind_ para incluirmos o código C# (C-Sharp) que listará os links do menu. Esse código deverá ser incluso no Page\_Load do nosso _MenuControl.ascx_. \[sourcecode language='csharp'\] // Instancia da classe de Negocio WebSite.Business.Paginas paginasBO = new WebSite.Business.Paginas(); // Chamada ao metodo que lista todas as paginas que irá gerar um array das mesmas WebSite.Entities.Paginas\[\] paginas = paginasBO.ListaPaginas(); // Realizando um laço de repetição no array para ler cada registro foreach (WebSite.Entities.Paginas pagina in paginas) { // Formatando a string para que seja gerado uma saida conforme exemplo //*   Titulo Pagina
string mnu = string.Format("*   [{1}](\"pagina.aspx?id={0}\")
", pagina.Id, pagina.Titulo); // Atribuindo o texto gerado no Server Control Literal ltlItensMenu.Text += mnu; } \[/sourcecode\] Agora que nosso menu está pronto, vamos inclui-lo na nossa MasterPage. Para isso abra a MasterPage no modo Design e arraste o MenuControl.ascx que está no Solution Explorer para dentro da MasterPage. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem014-300x162.jpg "imagem014")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem014.jpg) Seu HTML da MasterPage passará a ficar assim. \[sourcecode language='html'\] <%@ Master Language="C#" AutoEventWireup="true" CodeFile="MasterPage.master.cs" Inherits="MasterPage" %> <%-- Aqui ficou a referencia ao MenuControl.ascx --%> <%@ Register src="MenuControl.ascx" tagname="MenuControl" tagprefix="uc1" %>  @import url('css/default.css'); 

Projeto WebSite .NET
====================

<%-- Aqui ficou o nosso MenuContro.ascx --%>

&amp;amp;copy; 2012. Projeto WebSite .NET by [C# Brasil](http://raphaelcardoso.com.br)

\[/sourcecode\] Antes de executar nosso projeto, precisaremos incluir a _ConnectionString_ para conexão com o banco de dados. Para isso abra o _Web.config_ e inclua o código abaixo alterando somente os seus dados de conexao. \[sourcecode language='xml'\] \[/sourcecode\] Salve e execute seu projeto e teremos o resultado até o momento. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem015-300x162.jpg "imagem015")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem015.jpg) Se clicarmos nos links gerados a partir de nossa lista de páginas, irá ocorrer um erro 404 pois o arquivo _pagina.aspx_ ainda não existe. Mais agora é mais fácil criar página pois já temos nosso modelo criado, então criaremos o arquivo pagina.aspx e utilizaremos a MasterPage. Clique com o botão direito sobre o projeto e clique em _Add New Item_. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem016-300x162.jpg "imagem016")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem016.jpg) Defina o nome para o arquivo como _pagina.aspx_ e selecione a opção _Select master page_ [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem017-300x185.jpg "imagem017")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem017.jpg) Uma nova janela será aberta onde selecionaremos nossa master page. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem018-300x182.jpg "imagem018")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem018.jpg) Repare que o código HTML de nossa pagina.aspx quase não possui tags, isso porque já está tudo dentro da nossa MasterPage. \[sourcecode language='html'\] <%@ Page Title="" Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="pagina.aspx.cs" Inherits="pagina" %>  \[/sourcecode\] É entre as tag que iremos incluir o conteúdo do site. Porem será incluso a partir do banco de dados. Vamos implementar primeiro o HTML que deverá ficar assim. \[sourcecode language='html'\] <%@ Page Title="" Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="pagina.aspx.cs" Inherits="pagina" %> \[/sourcecode\] Repare que novamente fizemos uso do Literal. Ele será uma excelente opção para esses casos pois não queremos que seja gerado tags HTML extras. Agora vamos ao _CodeBehind_ para fazermos a busca das informações da página. Dentro dele terá o evento _Page\_Load_ e é onde incluiremos nossa chamada ao método para buscar o conteúdo da pagina e usando como informação o Id da página. O Id dá página é passado por QueryString. Para saber mais sobre QueryString acesse o [video aula](http://programandodotnet.wordpress.com/2012/01/22/videoaula-querystring/ "Video Aula - QueryString") do [Wellington Camargo](http://programandodotnet.wordpress.com). \[sourcecode language='csharp'\] // Recebe o ID da página por QueryString e pelo fato de o parametro ser String, realizamos a conversão para Integer int IdPagina; int.TryParse(Request.QueryString\["id"\], out IdPagina); // Caso não tenha sido passado o ID dá pagina, redireciona para a pagina padrão (default.aspx) if (IdPagina == 0) Response.Redirect("default.aspx"); // Instancia da classe de Negocio WebSite.Business.Paginas paginasBO = new WebSite.Business.Paginas(); // Chamada ao metodo que lista todas as paginas passando o ID da página e retornando o primeiro registro WebSite.Entities.Paginas pagina = paginasBO.ListaPaginas(new WebSite.Entities.Paginas(IdPagina)).FirstOrDefault(); // Atribuido os dados nos Literais this.Title = pagina.Titulo; ltlTitulo.Text = pagina.Titulo; ltlConteudo.Text = pagina.Texto; \[/sourcecode\] [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem019-300x162.jpg "imagem019")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem019.jpg) [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem020-300x162.jpg "imagem020")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem020.jpg) Como pode ver, em pouco tempo fomos capazes de desenvolver o nosso website e bem flexível, ou seja, caso desejamos ter mais página, basta realizarmos uma inserção na tabela PAGINAS que teremos mais páginas inclusas no menu. Vamos fazer um teste? Execute o script abaixo no banco de dados. \[sourcecode language='sql'\] INSERT INTO PAGINAS(TITULO\_PAGINA, TEXTO\_PAGINA, DATACRIACAO\_PAGINA, ATIVO\_PAGINA) VALUES('Produtos', 'Conteudo da página de produtos', GETDATE(), 1) INSERT INTO PAGINAS(TITULO\_PAGINA, TEXTO\_PAGINA, DATACRIACAO\_PAGINA, ATIVO\_PAGINA) VALUES('Clientes', 'Conteudo da página de clientes', GETDATE(), 1) \[/sourcecode\] Agora acesse sua página e repare que foram inclusos mais 2 páginas no menu. [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem021-300x162.jpg "imagem021")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem021.jpg) [![](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem022-300x162.jpg "imagem022")](https://raphaelcardoso.com.br/wp-content/uploads/2012/01/imagem022.jpg) Nosso projeto ficou muito simples e de fácil manutenção além de bem flexível o que nos permitira utilizar um mesmo projeto para diversos clientes bastando somente alterar o conteúdo do banco de dados. Até o momento você aprendeu:

*   Criar tabela e banco de dados;
*   Desenvolver camada de dados, entidades e negocio;
*   Criar páginas utilizando CSS, MasterPage e utilizando nossa camada de negocio.

Acha que acabou? Pode aguarde o próximo artigo que ainda tem muita coisa boa pela frente e iremos ainda criar nosso painel administrativo.

Fonte do projeto: [Github](https://github.com/csharpbrasil/projeto-website-aspnet)

Não deixe de participar do fórum. Siga o C# Brasil no [Twitter](http://twitter.com/csharpbrasil) e [Facebook](http://facebook.com/csharpbrasil). Até o próximo artigo e bons estudos!