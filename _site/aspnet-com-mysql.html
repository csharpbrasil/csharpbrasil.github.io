<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="C# Brasil">

	<title>ASP.NET com MySql</title>

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css?1716937206294534819">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800" rel="stylesheet" type="text/css">

    <link rel="shortcut icon" href="/images/favicon.png" />
</head>


<body>
	<div id="wrap">
	  	
    <!-- Navigation -->
    <nav id="nav">
	<div id="nav-list">
		<a href="http://localhost:4000/">Página inicial</a>
		<a href="http://localhost:4000/sobre">Sobre o blog</a>
	</div>
</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>
    <!-- Header -->
    <header id="header">
	<a href="http://localhost:4000/">
		<img src="/images/logo_csharpbrasil.png" class="logo" alt="C# Brasil">
	</a>
</header>

    <!-- Main content -->
	  <div id="container">
      <main>
        <article id="post-page">
	<h2>ASP.NET com MySql</h2>		
	<time datetime="2008-11-15T00:07:03-02:00" class="by-line">
		
		15
		Novembro
		  
		2008
	</time>
	<div class="content">

		<p>Existe hoje em dia vários tipos de banco de dados, mais nenhum deles me agrada mais que o MySql. Quando iniciei meu aprendizado em asp (vbscript), utilizava muito o Access, mais isso até conhecer o MySql que também foi minha escolha por ser um banco de dados gratuito e que esta disponível gratuitamente na maioria dos serviços de hospedagem. Minha escolha não foi só por isso, escolhi também por sua robustez, qualidade e facilidade de gerenciamento.</p>

<p>A um pouco mais de 1 ano iniciei o meu estudo com ASP.NET e não poderia deixar por menos, corri atrás de procurar informações sobre a utilização do MySql no ASP.NET e fui feliz. Hoje todas as minhas aplicações, seja ela desktop ou web são utilizando o MySql, ao contrario de muitos outros profissionais que preferem o Sql Server Express ou Firebird (tem suporte também que eu saiba para aplicações Windows Form).</p>

<p>Para utilizar o MySql, teremos duas opções de drive para conexão:</p>

<ol>
  <li><a href="http://dev.mysql.com/downloads/connector/odbc/5.1.html">MySQL Connector/ODBC 5.1</a></li>
  <li><a href="http://dev.mysql.com/downloads/connector/net/5.2.html">Connector/Net 5.2</a></li>
</ol>

<p>Particularmente prefiro a segunda opção. Então vamos colocar a mão na massa.</p>

<p>Faça o download do Drive Connector.NET 5.2 e instale que é o que eu mais indico por sua classes e métodos serem muito semelhantes aos drives do Sql Server e Oracle.</p>

<p>Você ira precisar instalar mais 2 ferramentas essenciais, o MySQL Administrator e MySQL Query Browser, além é claro do próprio MySql Server. Mais como não é o foco do artigo, não abordarei o passo a passo da instalação que alias é bem mais simples que os demais. Mais segue os links abaixo.</p>

<ul>
  <li><a href="http://dev.mysql.com/downloads/mysql/5.0.html">MySql Server 5.0</a></li>
  <li><a href="http://dev.mysql.com/downloads/gui-tools/5.0.html">MySQL Administrator e MySql Query Browser</a></li>
</ul>

<p>Depois de ter instalado o MySql Server, o Administrator e o Query Browser vamos iniciar um novo projeto no Visual Studio do tipo WebForm ASP.NET.</p>

<p>No <em>Solution Explorer</em> do Visual Studio, vamos adicionar a dll do MySql ao projeto que nos dará suporte a ele em nosso WebForm. Com o botão direito em no <em>Project</em> do <em>Solutions Explorer</em> e clique na opção <em>Add Reference…</em></p>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/11/mysqlaspnet001-1.jpg" alt="" title="mysqlaspnet001" /></p>

<p>Será aberto um nova janela onde iremos escolher a tab Browse e selecionaremos a dll do MySql Connector.NET que foi instalado. No meu caso o caminho é <strong><em>C:\Arquivos de programas\MySQL\MySQL Connector Net 5.2.2\Binaries\.NET 2.0\MySql.Data.dll</em></strong>.</p>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/11/mysqlaspnet002-1.jpg" alt="" title="mysqlaspnet002" /></p>

<p>Agora iremos crie um novo banco de dados e a tabela no MySql e para isso abra o Query Browser e execute o script abaixo.</p>

<p>[sourcecode language=’sql’] CREATE DATABASE `dbalbuns` CREATE TABLE `dbalbuns`.`albuns` ( `idalbum` int(10) unsigned NOT NULL AUTO_INCREMENT, `titulo` varchar(100) DEFAULT NULL, `descricao` varchar(100) DEFAULT NULL, `preco` decimal(18,2) DEFAULT ‘0.00’, PRIMARY KEY (`idalbum`) USING BTREE ) ENGINE=InnoDB DEFAULT CHARSET=latin1; [/sourcecode]</p>

<p>Criamos então no nosso banco de dados <strong><em>dbalbuns</em></strong> com a tabela <strong><em>albuns</em></strong>.</p>

<p>Vamos inserir alguns dados para que possamos começar a criar nosso exemplo.</p>

<p>[sourcecode language=’sql’] insert into albuns(titulo, descricao, preco) values(‘Armandinho’, ‘Reggae’, 30.99); insert into albuns(titulo, descricao, preco) values(‘Tom Jobim’, ‘MPB’, 43.56); insert into albuns(titulo, descricao, preco) values(‘Nirvana’, ‘Rock’, 27.90); [/sourcecode]</p>

<p>Volte ao Visual Studio e vamos adicionar um Grid na página Default.aspx</p>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/11/mysqlaspnet003-1.jpg" alt="" title="mysqlaspnet003" /></p>

<p>Abra o Code Behind do WebForm Default.aspx e declare o namespace do MySql</p>

<p>[sourcecode language=’csharp’] using MySql.Data.MySqlClient; [/sourcecode]</p>

<p>E vamos adicionar o código abaixo no Page_Load</p>

<p>[sourcecode language=’csharp’] protected void Page_Load(object sender, EventArgs e) { string connectionString = “server=localhost;uid=root;pwd=123456;database=dbalbuns”; MySqlConnection conn = new MySqlConnection(connectionString); MySqlCommand cmd = new MySqlCommand(); cmd.CommandText = “select * from albuns”; cmd.Connection = conn; DataTable dt = new DataTable(); MySqlDataAdapter da = new MySqlDataAdapter(cmd); da.Fill(dt); GridView1.DataSource = dt; GridView1.DataBind(); } [/sourcecode]</p>

<p>Se executarmos o nosso projeto, ira aparecer nosso WebForm no browser com os dados que cadastramos no MySql.</p>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/11/mysqlaspnet004-1.jpg" alt="" title="mysqlaspnet004" /></p>

<p>Podemos ainda dar uma incrementada no visual do nosso Grid.</p>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/11/mysqlaspnet005-1.jpg" alt="" title="mysqlaspnet005" /> <img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/11/mysqlaspnet006-1.jpg" alt="" title="mysqlaspnet006" /></p>

<p>É isso ai. Agora é por sua conta explorar um pouco mais da robustez do MySql com a facilidade do ASP.NET</p>

<p>Dúvidas? Deixe seu comentário!</p>

<p>Abraço e sucesso!!!</p>

		
	</div>
</article>


      </main>		
      <!-- Pagination links -->
      
	  </div>
    
    <!-- Footer -->
    <footer class="footer"><span>&copy; 2024 C# Brasil. Todos os direitos reservados | Versão: 1.0.0 </span></footer>
    <!-- Script -->
    <script src="/js/main.js"></script>	

	</div>
</body>
</html>
