<!DOCTYPE html>
<html>

<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T668JSDW');</script>
    <!-- End Google Tag Manager -->

	<!-- Meta -->
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Como saber se um aplicativo .NET é 32 ou 64 bits | C# Brasil</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Como saber se um aplicativo .NET é 32 ou 64 bits" />
<meta name="author" content="Raphael Cardoso" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="No desenvolvimento de aplicações .NET seja ela, ASP.NET, ASP.NET MVC, Windows Library, Windows Form é possível utilizamos algumas diversas linguagens para programação. Porem é possível também definir que nosso executável ou assembly rode em plataforma 32 bits, 64 bits ou para ambas as plataformas (Any CPU)." />
<meta property="og:description" content="No desenvolvimento de aplicações .NET seja ela, ASP.NET, ASP.NET MVC, Windows Library, Windows Form é possível utilizamos algumas diversas linguagens para programação. Porem é possível também definir que nosso executável ou assembly rode em plataforma 32 bits, 64 bits ou para ambas as plataformas (Any CPU)." />
<link rel="canonical" href="http://localhost:4000/como-saber-se-um-aplicativo-net-e-32-ou-64-bits" />
<meta property="og:url" content="http://localhost:4000/como-saber-se-um-aplicativo-net-e-32-ou-64-bits" />
<meta property="og:site_name" content="C# Brasil" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-02-28T08:59:10-03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Como saber se um aplicativo .NET é 32 ou 64 bits" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Raphael Cardoso","url":"http://www.csharpbrasil.com.br"},"dateModified":"2014-02-28T08:59:10-03:00","datePublished":"2014-02-28T08:59:10-03:00","description":"No desenvolvimento de aplicações .NET seja ela, ASP.NET, ASP.NET MVC, Windows Library, Windows Form é possível utilizamos algumas diversas linguagens para programação. Porem é possível também definir que nosso executável ou assembly rode em plataforma 32 bits, 64 bits ou para ambas as plataformas (Any CPU).","headline":"Como saber se um aplicativo .NET é 32 ou 64 bits","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/como-saber-se-um-aplicativo-net-e-32-ou-64-bits"},"url":"http://localhost:4000/como-saber-se-um-aplicativo-net-e-32-ou-64-bits"}</script>
<!-- End Jekyll SEO tag -->


	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css?1717257970198203784">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800" rel="stylesheet" type="text/css">

    <link rel="shortcut icon" href="/images/favicon.png" />
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NS9JFVVY3Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NS9JFVVY3Z');
</script>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T668JSDW"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

	<div id="wrap">
	  	
    <!-- Navigation -->
    <nav id="nav">
	<div id="nav-list">
		<a href="http://localhost:4000/">Página inicial</a>
		<a href="http://localhost:4000/sobre">Sobre o blog</a>
	</div>
</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>
    <!-- Header -->
    <header id="header">
	<a href="http://localhost:4000/">
		<img src="/images/logo_csharpbrasil.png" class="logo" alt="C# Brasil">
	</a>
</header>

    <!-- Main content -->
	  <div id="container">
      <main>
        <article id="post-page">
	<h2>Como saber se um aplicativo .NET é 32 ou 64 bits</h2>		
	<time datetime="2014-02-28T08:59:10-03:00" class="by-line">
		
		28
		Fevereiro
		  
		2014
	</time>
	<div class="content">

		<p>No desenvolvimento de aplicações .NET seja ela, ASP.NET, ASP.NET MVC, Windows Library, Windows Form é possível utilizamos algumas diversas linguagens para programação. Porem é possível também definir que nosso executável ou assembly rode em plataforma 32 bits, 64 bits ou para ambas as plataformas (Any CPU).</p>

<p>Mais imagina-se a seguinte situação, um pouco absurda, mais possível de se ocorrer. Você é um implantador de sistemas e deverá atender a uma demanda em um cliente. Implantar o sistema e se depara com um erro ao executar o sistema que acabou de instalar com a seguinte mensagem:</p>

<p><code class="language-plaintext highlighter-rouge">plain System.BadImageFormatException: Could not load file or assembly '' or one of it dependencies. An attempt was made to load programa with an incorrect format.</code></p>

<p>Alguns outros Exceptions poderão ser vistos aqui nesse artigo sobre <a href="https://raphaelcardoso.com.br/csharp/exceptions-do-net-framework/">Exceptions do .NET Framework</a></p>

<p>Esse erro ocorrer porque um assembly necessário não foi encontrado na tentativa de executar o sistema. Mais analisando o sistema, é identificado que o assembly se encontra junto ao projeto. Isso ocorre porque o assembly que tentou-se carregar está em uma plataforma diferente do sistema.</p>

<ul>
  <li>Exemplo 1: Aplicativo compilado para 32 bits e assembly para 64 bits</li>
  <li>Exemplo 2: Aplicativo compilado para 64 bits e assembly para 32 bits</li>
</ul>

<p>A solução para esses casos seria a compilação de ambos para a mesma plataforma.</p>

<p>No caso das aplicações ASP.NET, também ocorrem esse tipo de problema, onde se o sistema operacional for 64 bits, o Application Pooling no IIS (Internet Information Services) por padrão será 64 bits e no caso de aplicação ser compilada para 32 bits, ocorrerá o mesmo problema.</p>

<p>A solução para esse caso é compilar a aplicação para ambas as plataformas (Any CPU) ou para 64 bits. Outra solução seria definir o Application Pooling para rodar em modo 32 bits.</p>

<p>Recentemente me deparei com essa segunda situação que citei. O programador enviou um assembly em 32 bits e o IIS (Internet Information Services) do meu servidor estava com Application Pooling definido para 64 bits. Resultado, ocorreu um <strong>BadImageFormatException</strong>. A solução seria, mudar o assembly para 64 bits ou mudar o Application Pooling para 32 bits. Mais ai vem a pergunta, como ter certeza realmente para qual plataforma ela foi compilada?</p>

<p>Para responder a essa pergunta, basta efetuar o download do <a href="http://www.microsoft.com/en-us/download/details.aspx?id=8279">Microsoft Windows SDK for Windows 7 and .NET Framework 4</a>. e instala-lo. No SDK conterá as ferramentas necessárias.</p>

<p>Inicie a instalação do SDK.</p>

<p>[caption id=”attachment_4767” align=”aligncenter” width=”772”]<img src="/contents/2014/02/tela1.png" alt="Imagem da tela de inicio do setup do SDK" /> Imagem da tela de inicio do setup do SDK[/caption] [caption id=”attachment_4768” align=”aligncenter” width=”776”]<img src="/contents/2014/02/tela2.png" alt="Imagem da Tela de informações sobre o termo da licença de uso" /> Tela de informações sobre o termo da licença de uso[/caption] [caption id=”attachment_4769” align=”aligncenter” width=”771”]<img src="/contents/2014/02/tela3.png" alt="Imagem da Tela de definição do local de instalação do SDK" /> Imagem da Tela de definição do local de instalação do SDK[/caption] [caption id=”attachment_4770” align=”aligncenter” width=”777”]<img src="/contents/2014/02/tela4.png" alt="Imagem da tela de escolha das opções de instalação" /> Imagem da tela de escolha das opções de instalação[/caption] [caption id=”attachment_4771” align=”aligncenter” width=”772”]<img src="/contents/2014/02/tela5.png" alt="Imagem da tela sobre o aviso de inicio da instalação do SDK" /> Imagem da tela sobre o aviso de inicio da instalação do SDK[/caption] [caption id=”attachment_4772” align=”aligncenter” width=”775”]<img src="/contents/2014/02/tela6.png" alt="Imagem da tela de progresso da instalação do SDK" /> Imagem da tela de progresso da instalação do SDK[/caption] [caption id=”attachment_4773” align=”aligncenter” width=”773”]<img src="/contents/2014/02/tela7.png" alt="Imagem da tela de informação da conclusão da instalação do SDK" /> Imagem da tela de informação da conclusão da instalação do SDK[/caption]</p>

<p>Após a instalação, abra o prompt do SDK localizado no menu <em>Iniciar &gt; Microsoft Windows SDK v7.1 &gt; Windows SDK 7.1 Command Prompt</em> e digite o comando abaixo:</p>

<p><code class="language-plaintext highlighter-rouge">plain CorFlags</code> [caption id=”attachment_4774” align=”aligncenter” width=”684”]<img src="/contents/2014/02/tela8.png" alt="Imagem do prompt do SDK com a execução do comando citado" /> Imagem do prompt do SDK com a execução do comando citado[/caption]</p>

<p>No meu caso, esse comando irá gerar o resultado abaixo:</p>

<p><code class="language-plaintext highlighter-rouge">plain Version : v2.0.50727 CLR Header: 2.5 PE : PE32 CorFlags : 9 ILONLY : 1 32BIT : 0 Signed : 1</code></p>

<p>Para entender o resultado, criei a tabela abaixo que explica como identificar qual a plataforma do assembly</p>

<p>Plataforma</p>

<p>PE</p>

<p>ILONLY</p>

<p>32BIT</p>

<p>64 bits</p>

<p>PE32+</p>

<p>0</p>

<p>0</p>

<p>32 bits</p>

<p>PE32</p>

<p>0</p>

<p>1</p>

<p>32 bits / 64 bits</p>

<p>PE32</p>

<p>1</p>

<p>0</p>

<p>Considerando o resultado acima e seguindo a tabela abaixo, meu assembly é Any CPU, ou seja, é compilado para 32 e 64 bits.</p>

<p>Espero que essa dica seja útil e qualquer dúvida deixe seu comentário.</p>

<p>Abraço e bom estudo</p>

		
	</div>
	<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/pt_BR/sdk.js#xfbml=1&version=v20.0" nonce="T10lHT3x"></script>
<div class="fb-comments" data-href="http://localhost:4000/como-saber-se-um-aplicativo-net-e-32-ou-64-bits" data-width="" data-numposts="10"></div>


</article>


      </main>		
      <!-- Pagination links -->
      
	  </div>
    
    <!-- Footer -->
    <footer class="footer"><span>&copy; 2024 C# Brasil. Todos os direitos reservados | Versão: 1.0.0 </span></footer>
    <!-- Script -->
    <script src="/js/main.js"></script>	

	</div>
</body>
</html>
