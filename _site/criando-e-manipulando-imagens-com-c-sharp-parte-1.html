<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="C# Brasil">

	<title>Criando e Manipulando imagens com C-Sharp - Parte 1</title>

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css?1716937206294534819">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800" rel="stylesheet" type="text/css">

    <link rel="shortcut icon" href="/images/favicon.png" />
</head>


<body>
	<div id="wrap">
	  	
    <!-- Navigation -->
    <nav id="nav">
	<div id="nav-list">
		<a href="http://localhost:4000/">Página inicial</a>
		<a href="http://localhost:4000/sobre">Sobre o blog</a>
	</div>
</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>
    <!-- Header -->
    <header id="header">
	<a href="http://localhost:4000/">
		<img src="/images/logo_csharpbrasil.png" class="logo" alt="C# Brasil">
	</a>
</header>

    <!-- Main content -->
	  <div id="container">
      <main>
        <article id="post-page">
	<h2>Criando e Manipulando imagens com C-Sharp - Parte 1</h2>		
	<time datetime="2008-10-23T20:28:21-02:00" class="by-line">
		
		23
		Outubro
		  
		2008
	</time>
	<div class="content">

		<p>Vou iniciar uma serie de pequenos artigos ensinando como manipular e até criar imagens com C#.</p>

<p>Nesse primeiro artigo, vou ensinar como pegar uma imagem qualquer e corta-la em formato de um circulo como o exemplo abaixo.</p>

<p>[caption id=”attachment_238” align=”aligncenter” width=”300” caption=”Exemplos das miniaturas geradas com a nossa classe que criaremos nesse exemplo”]<a href="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens001-1.jpg"><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens001-1-300x186.jpg" alt="Exemplos das miniaturas geradas com a nossa classe que criaremos nesse exemplo" title="criandomanipulandoimagens001" /></a>[/caption]</p>

<p>Independente do tipo de projeto, o resultado será o mesmo, mais para ficar mais interessante, vamos inicie um novo projeto webform.</p>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens002-1-300x195.jpg" alt="" title="criandomanipulandoimagens002" /></p>

<p>Com o botão direito em cima do nosso <em>Project &gt; Add New Item…</em> iremos adicionar uma nova Classe chamada “ImageBuilder.cs”…</p>

<p><a href="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens003-1.jpg"><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens003-1-300x198.jpg" alt="" title="criandomanipulandoimagens003" /></a></p>

<p>…e inclua o código abaixo.</p>

<p>[sourcecode language=’csharp’] public byte[] ImagemRedonda(string Path) { // Carrega a imagem System.Drawing.Image imagem = System.Drawing.Bitmap.FromFile(Path); // Estancia a Classe que será responsavel em converter a imagem em Array de Byte System.IO.MemoryStream ms = new System.IO.MemoryStream(); // Atribui a imagem no Memory Stream criado imagem.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg); // Retorna um Array Byte conteudo a imagem return ms.ToArray(); } [/sourcecode]</p>

<p>Agora iremos incluir uma imagem no nosso projeto para usarmos como exemplo. Crie um pasta chamada “Imagens” e com o botão direito em cima dela clique em <em>Add Existing Item…</em> e escolha uma imagem do formato <strong><em>JPEG</em></strong> qualquer.</p>

<p>Crie um novo WebForm que será o responsável em exibir nossa imagem na página Default.aspx. Com o botão direito em cima do nosso <em>Project &gt; Add New Item…</em> iremos adicionar o WebForm chamada “Imagem.aspx”.</p>

<p><a href="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens004-1.jpg"><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens004-1.jpg" alt="" title="criandomanipulandoimagens004" /></a></p>

<p>Atribuir o código abaixo que receberá a QueryString “Path”, irá pegar o caminho físico e informa-lo para a nossa Classe “ImageBuilder” e essa exibirá a imagem.</p>

<p>[sourcecode language=’csharp’] protected void Page_Load(object sender, EventArgs e) { ImageBuilder img = new ImageBuilder(); string Path = Request.QueryString[“path”]; string ServerPath = Server.MapPath(Path); Response.ContentType = “image/jpeg” Response.BinaryWrite(img.ImagemRedonda(ServerPath)); } [/sourcecode]</p>

<table>
  <tbody>
    <tr>
      <td>No Default.aspx iremos chamar o página Imagem.aspx e passando a QueryString path=</td>
      <td>caminho_da_imagem</td>
      <td>igual o código abaixo.</td>
    </tr>
  </tbody>
</table>

<p>[sourcecode language=’xml’] [/sourcecode]</p>

<p>Se você fez os passos corretos, ao executar a imagem será exibida em seu tamanho real.</p>

<p><a href="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens005-1.jpg"><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens005-1.jpg" alt="" title="criandomanipulandoimagens005" /></a></p>

<p>Agora iremos ao que interessa. Na classe “ImageBuilder”, adicione os códigos abaixo que irá cortar e dar o formato arredondado para a imagem.</p>

<p>Esse código irá deixar a imagem em formado arredondado.</p>

<p>[sourcecode language=’csharp’] private System.Drawing.Image ArredondaImagem(System.Drawing.Image imgTemp, int Largura, int Altura) { System.Drawing.Image imagem = CortaImagem(imgTemp, Largura, Altura); System.Drawing.Graphics graphic = System.Drawing.Graphics.FromImage(imagem); System.Drawing.Rectangle retangulo = new System.Drawing.Rectangle(); System.Drawing.Pen PW = new System.Drawing.Pen(System.Drawing.Brushes.White, 2); for (int i = imagem.Height; i &lt; (imagem.Height * 2); i++) { retangulo.Height = i; retangulo.Width = i; retangulo.X = imagem.Width / 2 - retangulo.Width / 2; retangulo.Y = imagem.Height / 2 - retangulo.Height / 2; graphic.DrawEllipse(PW, retangulo); } return imagem; } [/sourcecode]</p>

<p>Esse código irá cortar a imagem</p>

<p>[sourcecode language=’csharp’] private static System.Drawing.Image CortaImagem(System.Drawing.Image imgPhoto, int Width, int Height) { int sourceWidth = imgPhoto.Width; int sourceHeight = imgPhoto.Height; int sourceX = 0; int sourceY = 0; int destX = 0; int destY = 0; float nPercent = 0; float nPercentW = 0; float nPercentH = 0; nPercentW = ((float)Width / (float)sourceWidth); nPercentH = ((float)Height / (float)sourceHeight); if (nPercentH &lt; nPercentW) { nPercent = nPercentW; destY = (int)((Height - (sourceHeight * nPercent)) / 2); } else { nPercent = nPercentH; destX = (int)((Width - (sourceWidth * nPercent)) / 2); } int destWidth = (int)(sourceWidth * nPercent); int destHeight = (int)(sourceHeight * nPercent); System.Drawing.Bitmap bmPhoto = new System.Drawing.Bitmap(Width, Height, System.Drawing.Imaging.PixelFormat.Format24bppRgb); bmPhoto.SetResolution(imgPhoto.HorizontalResolution, imgPhoto.VerticalResolution); System.Drawing.Graphics grPhoto = System.Drawing.Graphics.FromImage(bmPhoto); grPhoto.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic; grPhoto.DrawImage(imgPhoto, new System.Drawing.Rectangle(destX, destY, destWidth, destHeight), new System.Drawing.Rectangle(sourceX, sourceY, sourceWidth, sourceHeight), System.Drawing.GraphicsUnit.Pixel);</p>

<p>grPhoto.Dispose(); return bmPhoto; } [/sourcecode]</p>

<p>E agora alteraremos o metodo “ImagemRedonda” atribuindo a linha que Corta a imagem conforme o código abaixo: [sourcecode language=’csharp’] public byte[] ImagemRedonda(string Path) { // Carrega a imagem System.Drawing.Image imagem = System.Drawing.Bitmap.FromFile(Path); // Corta Imagem nas medidas informadas imagem = ArredondaImagem(imagem, 150, 150); // Estancia a Classe que será responsavel em converter a imagem em Array de Byte System.IO.MemoryStream ms = new System.IO.MemoryStream(); // Atribui a imagem no Memory Stream criado imagem.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg); // Retorna um Array Byte conteudo a imagem return ms.ToArray(); } [/sourcecode]</p>

<p>E aqui esta nosso resultado.</p>

<p><a href="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens006-1.jpg"><img src="https://raphaelcardoso.com.br/wp-content/uploads/2008/10/criandomanipulandoimagens006-1.jpg" alt="" title="criandomanipulandoimagens006" /></a></p>

<p>Espero que esse exemplo seja útil e aguarde que em breve postarei mais novos artigos nessa mesma linha, criando e manipulando imagens</p>

<p>Abraço e sucesso!!!</p>

		
	</div>
</article>


      </main>		
      <!-- Pagination links -->
      
	  </div>
    
    <!-- Footer -->
    <footer class="footer"><span>&copy; 2024 C# Brasil. Todos os direitos reservados | Versão: 1.0.0 </span></footer>
    <!-- Script -->
    <script src="/js/main.js"></script>	

	</div>
</body>
</html>
