<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="C# Brasil">

	<title>Criando e manipulando imagens com C-Sharp - Parte 2</title>

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css?1716937206294534819">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800" rel="stylesheet" type="text/css">

    <link rel="shortcut icon" href="/images/favicon.png" />
</head>


<body>
	<div id="wrap">
	  	
    <!-- Navigation -->
    <nav id="nav">
	<div id="nav-list">
		<a href="http://localhost:4000/">Página inicial</a>
		<a href="http://localhost:4000/sobre">Sobre o blog</a>
	</div>
</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>
    <!-- Header -->
    <header id="header">
	<a href="http://localhost:4000/">
		<img src="/images/logo_csharpbrasil.png" class="logo" alt="C# Brasil">
	</a>
</header>

    <!-- Main content -->
	  <div id="container">
      <main>
        <article id="post-page">
	<h2>Criando e manipulando imagens com C-Sharp - Parte 2</h2>		
	<time datetime="2009-04-06T10:23:37-03:00" class="by-line">
		
		6
		Abril
		  
		2009
	</time>
	<div class="content">

		<p>Seguindo a serie de artigos de criação e manipulação de imagens (veja o arquivo <a href="https://raphaelcardoso.com.br/criando-e-manipulando-imagens-com-c-sharp-parte-1/">anterior</a>), nesse artigo irei ensinar como remover as Meta Tags existentes em uma imagem do tipo JPG. Essas Meta Tags são chamadas de [W:Exif] (Exchangeable image file format) e nelas existem diversas informações sobre a imagens.</p>

<p>Normalmente encontramos essas Meta Tags nas fotos que são tiradas por câmeras fotográficas digitais. Eis algumas das informações encontradas.</p>

<ul>
  <li>Marca do Equipamento</li>
  <li>Software de Criação</li>
  <li>Velocidade do obturador</li>
  <li>Modo do Flash</li>
  <li>Comprimento focal</li>
  <li>Abertura do diafragma</li>
  <li>Tempo de exposição</li>
  <li>Data em que a foto foi tirada</li>
  <li>etc…</li>
</ul>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2009/04/criandomanipulandoimagens_parte2_01-1.jpg" alt="criandomanipulandoimagens_parte2_01" title="criandomanipulandoimagens_parte2_01" /></p>

<p>A principio utilizei essa técnica para editar uma foto sem a necessidade de utilizar o meu editor de imagens ([W:Photoshop]). Agora vamos ao que interessa.</p>

<p>[sourcecode language=’csharp’] private void RemoveExifProperties(string imagePath) { // Imagem original System.Drawing.Bitmap OriginalBitmap = new System.Drawing.Bitmap(imagePath); // Carrega a lista de propriedades da imagem System.Drawing.Imaging.PropertyItem[] aPropertyItem = OriginalBitmap.PropertyItems; foreach (System.Drawing.Imaging.PropertyItem property in aPropertyItem) { // Pega a propriedade atual da imagem System.Drawing.Imaging.PropertyItem p = property; // Atribui novo valor a propriedade p.Value = new byte[0]; // Seta a nova propriedade OriginalBitmap.SetPropertyItem(p); } // Salva a imagem em memoria System.IO.MemoryStream mStream = new System.IO.MemoryStream(); OriginalBitmap.Save(mStream, OriginalBitmap.RawFormat); OriginalBitmap.Dispose(); // Salva a imagem da memoria em arquivo System.Drawing.Bitmap CopyBitmap = new System.Drawing.Bitmap(mStream); CopyBitmap.Save(imagePath); CopyBitmap.Dispose(); mStream.Dispose(); } [/sourcecode]</p>

<p>No Código acima eu informo para o meu método o caminho físico da minha imagem que desejo remover as informações. Eu atribuo o array de propriedades da imagem a um variável do tipo System.Drawing.Imaging.PropertyItem[] e em seguida faço um foreach (laço de repetição) para pegar uma propriedade da imagem por vez e atribuir valor do tipo byte[0]. Faço isso porque o valor dá propriedade é do tipo array de byte(byte[]).</p>

<p>Feito isso, crio uma variável do tipo MemoryStream e salvo a imagem nela. Esse processo atribui a imagem em memória para que eu possa salva-la.</p>

<p>Ai vem a pergunta, porque não salvar diretamente em disco? Não poderia porque a imagem esta aberta e ocorreria um Exception ao tentar sobrescrever.</p>

<p>A solução é jogar a imagem modificada em memória para depois salva-la. Após realizar todo esse processo, daremos chamaremos o método Dispose para as variáveis do tipo Bitmap e MemoryStream para evitar descarregar as informações da memória.</p>

<p>Agora basta utilizar o método no projeto que precisar e passar somente o caminho físico da imagem para modificá-la.</p>

<p>[sourcecode language=’csharp’] private void btnProcessar_Click(object sender, EventArgs e) { string filePath = @”D:Minhas imagensS7301443.JPG”; RemoveExifProperties(filePath); } [/sourcecode]</p>

<p>E aqui temos o resultado.</p>

<p><img src="https://raphaelcardoso.com.br/wp-content/uploads/2009/04/criandomanipulandoimagens_parte2_02-1.jpg" alt="criandomanipulandoimagens_parte2_02" title="criandomanipulandoimagens_parte2_02" /></p>

<p>Algumas informações aparentemente não são removidas e sim atribuídas com seus valores padrões.</p>

<p>Espero que tenha entendido. Caso tenha alguma dúvida deixe seu comentário.</p>

<p>Abraço e sucesso!!!</p>

		
	</div>
</article>


      </main>		
      <!-- Pagination links -->
      
	  </div>
    
    <!-- Footer -->
    <footer class="footer"><span>&copy; 2024 C# Brasil. Todos os direitos reservados | Versão: 1.0.0 </span></footer>
    <!-- Script -->
    <script src="/js/main.js"></script>	

	</div>
</body>
</html>
