<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="C# Brasil">

	<title>Detectando MIME types com C#</title>

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css?1716937206294534819">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800" rel="stylesheet" type="text/css">

    <link rel="shortcut icon" href="/images/favicon.png" />
</head>


<body>
	<div id="wrap">
	  	
    <!-- Navigation -->
    <nav id="nav">
	<div id="nav-list">
		<a href="http://localhost:4000/">Página inicial</a>
		<a href="http://localhost:4000/sobre">Sobre o blog</a>
	</div>
</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>
    <!-- Header -->
    <header id="header">
	<a href="http://localhost:4000/">
		<img src="/images/logo_csharpbrasil.png" class="logo" alt="C# Brasil">
	</a>
</header>

    <!-- Main content -->
	  <div id="container">
      <main>
        <article id="post-page">
	<h2>Detectando MIME types com C#</h2>		
	<time datetime="2012-11-21T23:24:42-02:00" class="by-line">
		
		21
		Novembro
		  
		2012
	</time>
	<div class="content">

		<p>Normalmente em alguns aplicativos temos a necessidade de detectar o <a href="http://en.wikipedia.org/wiki/MIME">MIME type</a> de determinados arquivos. Segue abaixo uma classe MimeHelper que pode nos ajudar nessa tarefa, uma nota interessante foi a utilização de <a href="http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.80%29.aspx">Reflection</a> e a classe <a href="http://msdn.microsoft.com/pt-br/library/system.web.mimemapping.aspx">MimeMapping</a>.</p>

<table>
  <tbody>
    <tr>
      <td>[sourcecode language=’csharp’] using System; using System.Collections.Generic; using System.Linq; using System.Reflection; using System.Text; using System.Web; namespace WebHelpers { public static class MimeHelper { private static readonly object _locker = new object(); private static object _mimeMapping; private static readonly MethodInfo _getMimeMappingMethodInfo; static MimeHelper() { Type mimeMappingType = Assembly.GetAssembly(typeof(HttpRuntime)).GetType(“System.Web.MimeMapping”); if (mimeMappingType == null) throw new SystemException(“Não foi possível encontrar o tipo MimeMapping.”); _getMimeMappingMethodInfo = mimeMappingType.GetMethod(“GetMimeMapping”, BindingFlags.Static</td>
      <td>BindingFlags.NonPublic</td>
      <td>BindingFlags.Public); if (_getMimeMappingMethodInfo == null) throw new SystemException(“Não foi possível encontrar o método GetMimeMapping.”); if (_getMimeMappingMethodInfo.ReturnType != typeof(string)) throw new SystemException(“Método GetMimeMapping retornou um tipo inválido.”); if (_getMimeMappingMethodInfo.GetParameters().Length != 1 &amp;&amp; _getMimeMappingMethodInfo.GetParameters()[0].ParameterType != typeof(string)) throw new SystemException(“Método GetMimeMapping possui parâmentros inválidos.”); } public static string GetMimeType(string filename) { lock (_locker) return (string)_getMimeMappingMethodInfo.Invoke(_mimeMapping, new object[] { filename }); } } } [/sourcecode] Testando: [sourcecode language=’csharp’] using System; using System.IO; using System.Reflection; using System.Windows.Forms; using Microsoft.VisualStudio.TestTools.UnitTesting; using WebHelpers; namespace WebHelpers.Test { [TestClass()] public class MimeHelperTest { /// /// A test for GetMimeType /// [TestMethod()] public void GetMimeTypeTextPlainTest() { string filename = Path.Combine(@”C:\Visual Studio 2008\Projects\WebHelpers\WebHelpers.Test\”, “Files\\test.txt”); string expected = “text/plain”; string actual; actual = MimeHelper.GetMimeType(filename); Assert.AreEqual(expected, actual); } [TestMethod()] public void GetMimeTypeImageJpegTest() { string filename = Path.Combine(@”C:\Visual Studio 2008\Projects\WebHelpers\WebHelpers.Test\”, “Files\\test.JpG”); string expected = “image/jpeg”; string actual; actual = MimeHelper.GetMimeType(filename); Assert.AreEqual(expected, actual); } [TestMethod()] public void GetMimeTypeApplicationOctetStreamTest() { string filename = Path.Combine(@”C:\Visual Studio 2008\Projects\WebHelpers\WebHelpers.Test\”, “Files\\test.mp4”); string expected = “application/octet-stream”; string actual; actual = MimeHelper.GetMimeType(filename); Assert.AreEqual(expected, actual); } } } [/sourcecode]</td>
    </tr>
  </tbody>
</table>

		
	</div>
</article>


      </main>		
      <!-- Pagination links -->
      
	  </div>
    
    <!-- Footer -->
    <footer class="footer"><span>&copy; 2024 C# Brasil. Todos os direitos reservados | Versão: 1.0.0 </span></footer>
    <!-- Script -->
    <script src="/js/main.js"></script>	

	</div>
</body>
</html>
