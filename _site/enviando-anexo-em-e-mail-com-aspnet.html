<!DOCTYPE html>
<html>

<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T668JSDW');</script>
    <!-- End Google Tag Manager -->

	<!-- Meta -->
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Enviando anexo em e-mail com ASP.NET | C# Brasil</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Enviando anexo em e-mail com ASP.NET" />
<meta name="author" content="Raphael Cardoso" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Olá pessoa, a pedido de um amigo que recentemente começou programar em ASP.NET com C-Sharp, vou fazer um passo a passo de como enviar e-mail com anexo." />
<meta property="og:description" content="Olá pessoa, a pedido de um amigo que recentemente começou programar em ASP.NET com C-Sharp, vou fazer um passo a passo de como enviar e-mail com anexo." />
<link rel="canonical" href="http://localhost:4000/enviando-anexo-em-e-mail-com-aspnet" />
<meta property="og:url" content="http://localhost:4000/enviando-anexo-em-e-mail-com-aspnet" />
<meta property="og:site_name" content="C# Brasil" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-09-04T21:59:39-03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Enviando anexo em e-mail com ASP.NET" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Raphael Cardoso","url":"http://www.csharpbrasil.com.br"},"dateModified":"2008-09-04T21:59:39-03:00","datePublished":"2008-09-04T21:59:39-03:00","description":"Olá pessoa, a pedido de um amigo que recentemente começou programar em ASP.NET com C-Sharp, vou fazer um passo a passo de como enviar e-mail com anexo.","headline":"Enviando anexo em e-mail com ASP.NET","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/enviando-anexo-em-e-mail-com-aspnet"},"url":"http://localhost:4000/enviando-anexo-em-e-mail-com-aspnet"}</script>
<!-- End Jekyll SEO tag -->


	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css?1717257970198203784">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800" rel="stylesheet" type="text/css">

    <link rel="shortcut icon" href="/images/favicon.png" />
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NS9JFVVY3Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NS9JFVVY3Z');
</script>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T668JSDW"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

	<div id="wrap">
	  	
    <!-- Navigation -->
    <nav id="nav">
	<div id="nav-list">
		<a href="http://localhost:4000/">Página inicial</a>
		<a href="http://localhost:4000/sobre">Sobre o blog</a>
	</div>
</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>
    <!-- Header -->
    <header id="header">
	<a href="http://localhost:4000/">
		<img src="/images/logo_csharpbrasil.png" class="logo" alt="C# Brasil">
	</a>
</header>

    <!-- Main content -->
	  <div id="container">
      <main>
        <article id="post-page">
	<h2>Enviando anexo em e-mail com ASP.NET</h2>		
	<time datetime="2008-09-04T21:59:39-03:00" class="by-line">
		
		4
		Setembro
		  
		2008
	</time>
	<div class="content">

		<p>Olá pessoa, a pedido de um amigo que recentemente começou programar em ASP.NET com C-Sharp, vou fazer um passo a passo de como enviar e-mail com anexo.</p>

<p>Estou utilizando o Visual Studio 2005, mais quem não tiver poderá usar o Visual Web Developer Express 2005 ou 2008.</p>

<p>1- Crie um novo projeto ASP.NET Web Site</p>

<p><a href="/contents/2008/09/emailcomanexo01-1.jpg"><img src="/contents/2008/09/emailcomanexo01-1.jpg" alt="" title="emailcomanexo01" /></a></p>

<p>2- Na página inicial que será criada automaticamente nesse novo projeto, adicione 4 Labels, 3 TextBox, 1 FileUpload e 1 Button.</p>

<p><a href="/contents/2008/09/emailcomanexo02-1.jpg"><img src="/contents/2008/09/emailcomanexo02-1-300x228.jpg" alt="" title="emailcomanexo02" /></a></p>

<p>3- De um duplo clique no botão e vamos implementar as opções de envio. Declare as seguintes Namespaces: System.Net.Mail, System.Net e System.IO</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Net.Mail</span><span class="p">;</span> 
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span> 
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
</code></pre></div></div>

<p>4- No método do botão vamos atribuir o código abaixo.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">protected</span> <span class="k">void</span> <span class="nf">btnEnviar_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
	<span class="c1">// Estancia da Classe de Mensagem</span>
	<span class="n">MailMessage</span> <span class="n">_mailMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MailMessage</span><span class="p">();</span>
	<span class="c1">// Remetente</span>
	<span class="n">_mailMessage</span><span class="p">.</span><span class="n">From</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MailAddress</span><span class="p">(</span><span class="s">"meuemail@meuservidor.com"</span><span class="p">);</span>
	<span class="c1">// Destinatario</span>
	<span class="n">_mailMessage</span><span class="p">.</span><span class="n">CC</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">txtEmail</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>
	<span class="c1">// Assunto</span>
	<span class="n">_mailMessage</span><span class="p">.</span><span class="n">Subject</span> <span class="p">=</span> <span class="s">"Email com Anexo"</span><span class="p">;</span>
	<span class="c1">// A mensagem é do tipo HTML ou Texto Puro?</span>
	<span class="n">_mailMessage</span><span class="p">.</span><span class="n">IsBodyHtml</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
	<span class="c1">// Corpo da Mensagem</span>
	<span class="n">_mailMessage</span><span class="p">.</span><span class="n">Body</span> <span class="p">=</span> <span class="n">txtNome</span><span class="p">.</span><span class="n">Text</span> <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">txtMensagem</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>

	<span class="c1">// Recupera o binario enviado pelo FileUpload</span>
	<span class="n">MemoryStream</span> <span class="n">MS</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">fileAnexo</span><span class="p">.</span><span class="n">FileBytes</span><span class="p">);</span>
	<span class="c1">// Anexa o Stream do arquivo</span>
	<span class="n">Attachment</span> <span class="n">anexo</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Attachment</span><span class="p">(</span><span class="n">MS</span><span class="p">,</span> <span class="n">fileAnexo</span><span class="p">.</span><span class="n">FileName</span><span class="p">);</span>
	<span class="n">_mailMessage</span><span class="p">.</span><span class="n">Attachments</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">anexo</span><span class="p">);</span>

	<span class="c1">// Estancia a Classe de Envio</span>
	<span class="n">SmtpClient</span> <span class="n">_smtpClient</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SmtpClient</span><span class="p">(</span><span class="s">"smtp.meuservidor.com"</span><span class="p">);</span>
	<span class="c1">// Credencial para envio por SMTP Seguro (Quando o servidor exige autenticação)</span>
	<span class="n">_smtpClient</span><span class="p">.</span><span class="n">Credentials</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">NetworkCredential</span><span class="p">(</span><span class="s">"meuemail@meuservidor.com"</span><span class="p">,</span> <span class="s">"123minhasenha"</span><span class="p">);</span>
	<span class="c1">// Envia a mensagem</span>
	<span class="n">_smtpClient</span><span class="p">.</span><span class="nf">Send</span><span class="p">(</span><span class="n">_mailMessage</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>

<p>Pronto, se executarmos o nosso código iremos receber o e-mail com as informações e anexo informado.</p>

<p><a href="/contents/2008/09/emailcomanexo04-1.jpg"><img src="/contents/2008/09/emailcomanexo04-1.jpg" alt="" title="emailcomanexo04" /></a></p>

<p>Revisão: A mesma técnica utilizada para envio de e-mail no webform, segue para o winform.<br />
Quem tiver idéias de artigos, deixe seu comentário que irei providenciar para as próximas postagens.</p>

<p>Abraço a todos.</p>

		
	</div>
	<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/pt_BR/sdk.js#xfbml=1&version=v20.0" nonce="T10lHT3x"></script>
<div class="fb-comments" data-href="http://localhost:4000/enviando-anexo-em-e-mail-com-aspnet" data-width="" data-numposts="10"></div>


</article>


      </main>		
      <!-- Pagination links -->
      
	  </div>
    
    <!-- Footer -->
    <footer class="footer"><span>&copy; 2024 C# Brasil. Todos os direitos reservados | Versão: 1.0.0 </span></footer>
    <!-- Script -->
    <script src="/js/main.js"></script>	

	</div>
</body>
</html>
