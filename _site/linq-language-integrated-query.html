<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="C# Brasil">

	<title>LINQ - Language Integrated Query</title>

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css?1716937206294534819">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800" rel="stylesheet" type="text/css">

    <link rel="shortcut icon" href="/images/favicon.png" />
</head>


<body>
	<div id="wrap">
	  	
    <!-- Navigation -->
    <nav id="nav">
	<div id="nav-list">
		<a href="http://localhost:4000/">Página inicial</a>
		<a href="http://localhost:4000/sobre">Sobre o blog</a>
	</div>
</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>
    <!-- Header -->
    <header id="header">
	<a href="http://localhost:4000/">
		<img src="/images/logo_csharpbrasil.png" class="logo" alt="C# Brasil">
	</a>
</header>

    <!-- Main content -->
	  <div id="container">
      <main>
        <article id="post-page">
	<h2>LINQ - Language Integrated Query</h2>		
	<time datetime="2010-11-16T13:30:28-02:00" class="by-line">
		
		16
		Novembro
		  
		2010
	</time>
	<div class="content">

		<p>Recentemente recebi a <a href="https://novatec.com.br/livros/como-programar-com-aspnet-c-2ed/">2ª edição do livro “Como programar com ASP.NET e C#”</a> do autor <a href="http://twitter.com/AlfredoLotar">Alfredo Lotar</a> enviado como cortesia pela <a href="http://www.novatec.com.br/">Editora Novatec</a> para fazer uma <a href="https://raphaelcardoso.com.br/como-programar-com-asp-net-e-c-editora-novate/">resenha sobre ele</a>. Como já conheço a qualidade do trabalho do <a href="http://twitter.com/AlfredoLotar">Alfredo Lotar</a> então dei inicio ao estudo sobre LINQ que era o meu maior interesse até então.</p>

<p>Mais o que vem a ser o LINQ? Language Integrated Query ou simplesmente LINQ consistem em um modelo de programação unificado para extrair e atualizar dados de diferentes fontes de dados utilizando uma sintaxe conhecida como por exemplo o C# (C-Sharp).</p>

<p>Com o LINQ podemos por exemplo manipular um array com uma sintaxe bem simples. Então vamos a um pequeno exemplo.</p>

<p>[sourcecode language=’sql’] int[] num = { 1, 8, 3, 6, 5, 0, 4, 7, 2, 9 }; var obj = from n in num where n &gt; 5 select n; GridView1.DataSource = obj; GridView1.DataBind(); [/sourcecode]</p>

<p>Como por ver no exemplo anterior, criar um array de inteiros (int ou integer) com numero. Utilizando instrução LINQ realizei uma consulta e retornando os numeros maiores que 5. E o resultado irá retornar os numeros 8, 6, 7 e 9.</p>

<p>Agora vamos a mais alguns exemplos:</p>

<h5 id="ordenando-dados-usando-orderby">Ordenando dados usando <strong>ORDERBY</strong></h5>

<p>[sourcecode language=’sql’] var obj = from n in num where n &gt; 5 orderby n select n; [/sourcecode]</p>

<h5 id="organizando-os-dados-em-ordem-ascendente-usando-orderby-e-ascending">Organizando os dados em ordem ascendente usando <strong>ORDERBY</strong> e <strong>ASCENDING</strong></h5>

<p>[sourcecode language=’sql’] var obj = from n in num where n &gt; 5 orderby n ascending select n; [/sourcecode]</p>

<h5 id="organizando-os-dados-em-ordem-descendente-usando-orderby-e-descending">Organizando os dados em ordem descendente usando <strong>ORDERBY</strong> e <strong>DESCENDING</strong></h5>

<p>[sourcecode language=’sql’] var obj = from n in num where n &gt; 5 orderby n descending select n; [/sourcecode]</p>

<p>Faremos em seguinda um pouco diferente. Dessa vez teremos um array de string.</p>

<p>[sourcecode language=’sql’] string[] nomes = { “Joao”, “Maria”, “Paulo”, “Rita”, “Vitor”, “Suzana”, “Denis”, “Ana”, “Jose”, “Beatriz”, “Marcia” }; var obj = from n in nomes where n.Length &gt; 4 select n; GridView1.DataSource = obj; GridView1.DataBind(); [/sourcecode]</p>

<p>Você viu no exemplo anterior uma lista de nomes na qual eu realizei uma consulta solicitando que fosse retornado os nomes que tivessem mais de 4 caracteres.</p>

<p>Agora vamos complicar um pouco as coisas. Vamos criar uma estrutura chamado <em>Cliente</em> as propriedades <em>Codigo</em> e <em>Nome</em> e nela implementaremos a Interface <em>IComparable</em> para nos dar a possibilidade de criar uma ordenação de dados usando o LINQ.</p>

<p>[sourcecode language=’csharp’] public class Cliente : IComparable { public int Codigo { get; set; } public string Nome { get; set; } public Cliente() { } public Cliente(int Codigo, string Nome) { this.Codigo = Codigo; this.Nome = Nome; } public int CompareTo(object obj) { Cliente temp = (Cliente)obj; if (this.Codigo &lt; temp.Codigo) { return 1; } if (this.Codigo &gt; temp.Codigo) { return -1; } else { return 0; } } } [/sourcecode]</p>

<p>Agora usaremos a estrutura criando um array e adicionando dados.</p>

<p>[sourcecode language=’csharp’] List lstClientes = new List(); lstClientes.Add(new Cliente(3, “Maria”)); lstClientes.Add(new Cliente(5, “Pedro”)); lstClientes.Add(new Cliente(1, “Paulo”)); lstClientes.Add(new Cliente(4, “Rita”)); lstClientes.Add(new Cliente(2, “João”)); [/sourcecode]</p>

<p>Depois de criado nosso array de <em>Cliente</em> com os dados, vamos a nossa consulta usando LINQ.</p>

<p>[sourcecode language=’sql’] var obj = from c in lstClientes.ToArray() select c; [/sourcecode]</p>

<p>O exemplo anterior não é diferente dos já citados a não ser por um pequeno detalhe. Se executarmos o código abaixo e apresenta-lo no <em>GridView</em>, será exibido o <em>Codigo</em> e o <em>Nome</em>. Mais podemos limitar isso como por exemplo exibir somente o Nome. Veja o exemplo:</p>

<p>[sourcecode language=’sql’] var obj = from c in lstClientes.ToArray() select new { c.Nome }; [/sourcecode]</p>

<p>Vamos agora atribuir um filtro a nossa consulta e ordenar.</p>

<p>[sourcecode language=’sql’] var obj = from c in lstClientes.ToArray() where c.Nome.Contains(“P”) orderby c.Codigo ascending select new { c.Codigo, c.Nome }; [/sourcecode]</p>

<p>Na consulta anterior realizamos a busca de nomes iniciados com <em>“P”</em> e ainda ordenamos por <em>Codigo</em></p>

<p>A vantagens de se usar o LINQ é que temos uma flexibilidade muito grande para realizar consultar o que torna o código mais compacto e mais compreensível. Mais as vantagens não para por ai. Podemos ainda:</p>

<h5 id="junção-de-2-ou-mais-estruturas-com-join">Junção de 2 ou mais estruturas com <em>JOIN</em>:</h5>

<h5 id="sourcecode-languagesql-var-obj--from-p-in-pessoas-join-c-in-cidades-on-pidcidade-equals-cidcidade-join-u-in-ufs-on-ciduf-equals-uiduf-select-new--pidpessoa-pnomepessoa-cnomecidade-usiglauf--sourcecode">[sourcecode language=’sql’] var obj = from p in pessoas join c in cidades on p.IdCidade equals c.IdCidade join u in ufs on c.IdUf equals u.IdUf select new { p.IdPessoa, p.NomePessoa, c.NomeCidade, u.SiglaUf }; [/sourcecode]</h5>

<h5 id="agrupamento-com-group-by">Agrupamento com <em>GROUP BY</em>:</h5>

<p>[sourcecode language=’sql’] var obj = from p in pessoas join c in cidades on p.IdCidade equals c.IdCidade join u in ufs on c.IdUf equals u.IdUf group u by u.IdUf into grupo from g in grupo.Distinct() select new { g.IdUf, g.SiglaUf, TotalPessoas = grupo.Count() }; [/sourcecode]</p>

<p>Enfim, existe muito mais opções de uso do LINQ e que com certeza deixará nosso trabalho mais facil e um código mais simples. Lembrando que o uso do LINQ não se limita aos exemplos acima mencionado e que o mesmo pode ser feito a consultas a dados.</p>

<p>Ainda para finalizar, deixo uma dica para você que quer treinar a aprender mais da sintaxe do LINQ e de quebra realizar consulta diretamente a um banco de dados, bastando usar o <a href="http://www.linqpad.net/">LINQPAD</a></p>

<p>[caption id=”attachment_1405” align=”aligncenter” width=”300” caption=”Exemplo de uso do LINQ no LINQPAD”]<a href="https://raphaelcardoso.com.br/wp-content/uploads/2010/11/linqpad-1.jpg"><img src="https://raphaelcardoso.com.br/wp-content/uploads/2010/11/linqpad-1-300x193.jpg" alt="Exemplo de uso do LINQ no LINQPAD" title="linqpad" /></a>[/caption]</p>

<p>Abraço e bom estudo!</p>

<p><em>“Se um dia você tiver que escolher entre o mundo e o amor, lembre-se: Se escolher o mundo ficará sem amor, mas se você escolher o amor, com ele conquistará o mundo” (Albert Einstein)</em></p>

		
	</div>
</article>


      </main>		
      <!-- Pagination links -->
      
	  </div>
    
    <!-- Footer -->
    <footer class="footer"><span>&copy; 2024 C# Brasil. Todos os direitos reservados | Versão: 1.0.0 </span></footer>
    <!-- Script -->
    <script src="/js/main.js"></script>	

	</div>
</body>
</html>
